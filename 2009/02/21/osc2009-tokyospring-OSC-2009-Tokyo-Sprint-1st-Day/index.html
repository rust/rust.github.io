<!DOCTYPE html>
<html lang="en">

<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="">
  <meta name="generator" content="Hugo 0.19-DEV" />

  <title>OSC 2009 Tokyo/Sprint 1st Day &middot; なんとなく日記</title>

  
  
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pure/0.6.0/pure-min.css">

  <!--[if lte IE 8]>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pure/0.6.0/grids-responsive-old-ie-min.css">
  <![endif]-->
  <!--[if gt IE 8]><!-->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pure/0.6.0/grids-responsive-min.css">
  <!--<![endif]-->

  <!--[if lte IE 8]>
  <link rel="stylesheet" href="https://stnard.jp/css/side-menu-old-ie.css">
  <![endif]-->
  <!--[if gt IE 8]><!-->
  <link rel="stylesheet" href="https://stnard.jp/css/side-menu.css">
  <!--<![endif]-->

  <link rel="stylesheet" href="https://stnard.jp/css/blackburn.css">

  
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.5.0/css/font-awesome.min.css">

  
  <link href="https://fonts.googleapis.com/css?family=Raleway" rel="stylesheet" type="text/css">

  
  

  
  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.1.0/styles/androidstudio.min.css">
  <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.1.0/highlight.min.js"></script>
  <script>hljs.initHighlightingOnLoad();</script>
  

  <link rel="shortcut icon" href="https://stnard.jp/img/favicon.ico" type="image/x-icon" />

  
    <link rel="stylesheet" href="https://stnard.jp/css/custom.css">
  
  

</head>


<body>
<div id="layout">

  
<a href="#menu" id="menuLink" class="menu-link">
  
  <span></span>
</a>
<div id="menu">

  
  <a class="pure-menu-heading brand" href="https://stnard.jp/">stnard.jp</a>


  <div class="pure-menu">
    <ul class="pure-menu-list">
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://stnard.jp/"><i class='fa fa-home fa-fw'></i>Home</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://blog.stnard.jp"><i class='fa fa-list fa-fw'></i>Blog</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://stnard.jp/post/"><i class='fa fa-list fa-fw'></i>Old Posts</a>
      
        </li>
      
    </ul>
  </div>

  <div class="pure-menu social">
  <ul class="pure-menu-list">

    

    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://twitter.com/conceal_rs" target="_blank"><i class="fa fa-twitter-square fa-fw"></i>Twitter</a>
    </li>
    

    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://facebook.com/rust.ogawa" target="_blank"><i class="fa fa-facebook-square fa-fw"></i>Facebook</a>
    </li>
    

    

    

    

    

    

    

    

    

    

    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="http://slideshare.net/rust" target="_blank"><i class="fa fa-slideshare fa-fw"></i>SlideShare</a>
    </li>
    

    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://linkedin.com/in/shin-ichiro-ogawa-2711891b" target="_blank"><i class="fa fa-linkedin-square fa-fw"></i>LinkedIn</a>
    </li>
    

    

    

    

    

    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://github.com/rust" target="_blank"><i class="fa fa-github-square fa-fw"></i>GitHub</a>
    </li>
    

    

    

    

    

    

    

    

    

    

    

  </ul>
</div>


  <div>
  <div class="small-print">
    <small>&copy; 2016. All rights reserved.</small>
  </div>
  <div class="small-print">
    <small>Built with&nbsp;<a href="https://gohugo.io/" target="_blank">Hugo</a></small>
    <small>Theme&nbsp;<a href="https://github.com/yoshiharuyamashita/blackburn" target="_blank">Blackburn</a></small>
  </div>
</div>

</div>


  <div id="main">


<div class="header">
  <h1>OSC 2009 Tokyo/Sprint 1st Day</h1>
  <h2></h2>
</div>
<div class="content">

  <div class="post-meta">

  <div>
    <i class="fa fa-calendar fa-fw"></i>
    <time>2009/02/21</time>
  </div>

  

  

  

</div>


  <ul>
<li>emobile の設定しわすれてネットつながらない・・・・</li>
</ul>

<p>##仮想化環境の設計手法～プロのテクニック教えます～</p>

<ul>
<li>仮想化で問われるのはセンス</li>
<li>プロのテクニックとは

<ul>
<li>知ってるか知らないか</li>
</ul></li>
</ul>

<p>###設計のポイント</p>

<ul>
<li>既存環境の移行が一番多い</li>
<li>ちゃんと設計をするとコストは下がる

<ul>
<li>押し上げる要因は過大な見積り</li>
<li>Hardwareの見積りをしっかりすれば，コストは下がる．</li>
<li>コストの適正化</li>
<li>性能が足りなくなったら，スケールアウトする</li>
<li>コスト削減のメリット・デメリットを「見える化」する</li>
<li>システム寿命を2年増やす =&gt; 仮想化する・しないの場合での見積り</li>
</ul></li>
</ul>

<p>###設計フェーズ</p>

<ul>
<li>論理的な機能(サーバ)を整理する

<ul>
<li>物理マシンじゃなくて，論理機能として抽象化して整理する</li>
<li>いま2GHz/8GBだからといって，そのまま落としこまない</li>
</ul></li>
<li>仮想化の設計をする

<ul>
<li>まだ物理マシンは出てこない</li>
<li>コンピュータリソースは無制限だと考える</li>
</ul></li>
<li>注意点

<ul>
<li>リソースプールは最低3台で構成するのが望ましい</li>
<li>どのHardwareで動くかは考えない．考えてはいけない．</li>
<li>障害発生時はリソースプール内で相互にカバーする</li>
<li>なのでStand-byサーバはない</li>
</ul></li>
</ul>

<p>###設計手順詳細</p>

<ul>
<li>サーバのリストアップ

<ul>
<li>重要度と負荷率で，ABCランクをつける</li>
</ul></li>
<li>マシングループ毎に仕分け

<ul>
<li>マシン間の関連を書いておく</li>
</ul></li>
<li>グループ毎の要求リソースを算出

<ul>
<li>I/O, Network が算出しづらいので，現行サーバのを調べておく</li>
</ul></li>
<li>CPU/メモリは搭載量 x 60% と考える</li>
</ul>

<p>###ハードウェアの選定</p>

<ul>
<li>1台あたり16GB積むのを指標とする

<ul>
<li>場合によっては32GB/64GBもありうる</li>
</ul></li>
<li>高速なI/Oが必須</li>
<li>CPU使用率

<ul>
<li>CPU使用率30%の物理マシンを仮想マシンに</li>
<li>CPU60%ルールなら，VM2台 とか</li>
</ul></li>
</ul>

<p>###ブレード or ラックマウント？</p>

<ul>
<li>最低3台</li>
<li>4台以上なら，ブレード？

<ul>
<li>今後の増強計画を考えると，ラックマウントよりもブレードで用意しておいたほうがいい</li>
<li>ブレードの弱点も克服されつつある</li>
<li>HDDがなくなり，SSD/USB/Sun Bootになり，空き容量にメモリを搭載できるようになるようだ</li>
</ul></li>
</ul>

<p>###CPUの仮想化</p>

<ul>
<li>1VM CPU を 1物理 CPU　に割り付ける

<ul>
<li>VM が idle でも Host はそれがわからないので，割り当ててしまう</li>
</ul></li>
</ul>

<p>###ネットワーク構成</p>

<ul>
<li>4系統あるほうがいい

<ul>
<li>通常</li>
<li>管理用</li>
<li>ストレージ用</li>
<li>ライブマイグレーション用</li>
</ul></li>
<li>ブレードのパーツは ebay で買えば安い

<ul>
<li>販売代行しているらしい</li>
</ul></li>
</ul>

<p>###ストレージの選定</p>

<ul>
<li>OpenSolaris で ZFS が最近のトレンドらしい

<ul>
<li>お手軽らしい</li>
</ul></li>
<li>仮想化はネットワーク前提で考える</li>
<li>無停止で容量追加

<ul>
<li>Linux ならできるが，何に追加するのか(DBに追加など)を考える</li>
</ul></li>
<li>ストレージ側のスナップショット

<ul>
<li>バックアップに有効だが，費用対効果の見極めが肝心</li>
</ul></li>
<li>レプリケーション

<ul>
<li>DRBD</li>
<li>小さいファイルなら rsync など</li>
</ul></li>
</ul>

<p>###ベンチマークなど</p>

<ul>
<li>キャッシュが効いている</li>
<li>検索主体のDB(MySQLのSlaveなど)であれば，性能劣化は少ない

<ul>
<li>クックパッドはそういう構成だった気がする</li>
</ul></li>
<li>NFSサーバが刺さると怖い

<ul>
<li>負荷テストはしっかりやるべき</li>
<li>OSの信頼性も重要ではないかな</li>
</ul></li>
</ul>

<p>##昼休憩</p>

<ul>
<li>新宿駅側のルノアールでノートPCの昼ご飯</li>
</ul>

<p>##Web技術の現状と将来</p>

<ul>
<li>SFCの人</li>
</ul>

<p>###W3Cの紹介</p>

<ul>
<li>Im Berners-Lee により創設(Web = hypertest + internet を考え出した人)</li>
<li>W3C が Web の標準仕様を策定している

<ul>
<li>啓蒙活動と将来についての提案もしているようだ</li>
</ul></li>
<li>3つのホスト組織が運営

<ul>
<li>MIT</li>
<li>ERCIM</li>
<li>慶應義塾大学</li>
<li>日本の意向の取り入れや、アジア言語の取り扱いなど</li>
</ul></li>
<li>それ以外に W3C オフィスがある

<ul>
<li>主にプロモーション活動</li>
</ul></li>
<li>標準化のプロセス

<ul>
<li>Working Draft -&gt; Last Call -&gt; Candidate -&gt; Proposed -&gt; Recommendation(勧告)</li>
<li>「多くの人がどうこう言うより、一人の天才に決めてもらおう」という思想</li>
</ul></li>
<li>Validator を提供</li>
</ul>

<p>###W3Cからのお願い</p>

<ul>
<li>第２の「新しいWeb時代」が来る</li>
</ul>

<p>###W3Cでの最新の活動紹介</p>

<ul>
<li>Video関係

<ul>
<li>Video in the Web の活動</li>
<li>Video の中に識別子を埋め込んで、それを URI で指定できるような</li>
</ul></li>
<li>JLTF

<ul>
<li>日本語レイアウトをブラウザでみられるようにしよう</li>
<li>日本語の半組を英語で定義する</li>
<li>ルビをどう表示するかなど</li>
</ul></li>
<li>SVG

<ul>
<li>地図などをベクターフォーマットで表示するなど</li>
</ul></li>
<li>MMI

<ul>
<li>Multi Modal Interface</li>
<li>機器のデータをどう書き，どう表示するか</li>
</ul></li>
<li>HTMLの標準化

<ul>
<li>HTML 5.0 は XHTML 1.0 の後継ではない</li>
<li>Flash などに対抗しうる Web 標準機能の提供</li>
<li>これができればいいが</li>
</ul></li>
</ul>

<p>###HTML5 について</p>

<ul>
<li>&lt;canvas&gt; のデモ

<ul>
<li>HTML+CSS+JavaScript のみ</li>
<li>2D/3D処理が可能</li>
<li>わりとスムーズに動作する</li>
</ul></li>
<li>標準機能だけで Video の再生・コントロールなどが可能になる</li>
<li>native で drag &amp; drop に対応する

<ul>
<li>JavaScript との連携が必要になるが，native 対応しているのはいいんじゃないかな</li>
</ul></li>
<li>&lt;input type=&ldquo;date&rdquo; /&gt; がある

<ul>
<li>日付選択の &lt;input /&gt;</li>
</ul></li>
<li>Shibuya.JS++</li>
</ul>

<p>##進化し続けるオープンソースアプリケーションサーバ : GlassFish
###GlassFish とは</p>

<ul>
<li>アプリケーションサーバ</li>
<li>JavaEE 5 完全準拠</li>
<li>Web 2.0 対応

<ul>
<li>Comet/Web サービス

<ul>
<li>性能が十分であるということらしい</li>
</ul></li>
</ul></li>
</ul>

<p>###有償ユーザの付加価値</p>

<ul>
<li>パフォーマンス監視ツール

<ul>
<li>Heap Dump をリアルタイムで取得して，解析できる</li>
<li>通常のモニター機能もある</li>
</ul></li>
<li>パフォーマンスアドバイザー

<ul>
<li>管理画面に追加される機能</li>
<li>メモリ使用量やメモリリーク，CPU 使用率や GC 停止時間に関して，警告を出すことができる</li>
<li>監視ツールの詳細設定版のような感じ</li>
</ul></li>
<li>SNMP での監視機能</li>
</ul>

<p>###開発環境と実行環境</p>

<ul>
<li>NetBeans/Eclipse などに統合して開発可能</li>
<li>実行は Linux/Windows/Solaris など</li>
</ul>

<p>###GlassFish ポートフォリオ</p>

<ul>
<li>Web Stack

<ul>
<li>LAMP/SAMP スタック</li>
<li>PHP/Ruby/&hellip;/MySQL/&hellip;/memcached/etc.</li>
</ul></li>
</ul>

<p>###GlassFish ESB</p>

<ul>
<li>SOA の実行基盤</li>
<li>OpenESB + GlassFish

<ul>
<li>OpenESB</li>
<li>Sun のオープンソースの JBI(JSR-208) 実装</li>
</ul></li>
<li>Java CAPS との違い

<ul>
<li>各種サービス・コンポーネント・システムとの連携アダプタがあるかどうか</li>
</ul></li>
<li>JBI とは

<ul>
<li>SOAP に基づく Web サービスの使用をビジネス統合できるように改善</li>
<li>XMl で Web サービスを定義</li>
<li>Web サービスにおける非同期処理に対応</li>
</ul></li>
<li>メッセージ交換で祖結合を実現

<ul>
<li>WSDL でメッセージ交換の操作を実現</li>
</ul></li>
<li>NetBeans で統合開発</li>
<li>Web サービスの Mashup のような感じで，コネクターを通じて各種サービスに接続し，連携することができる</li>
</ul>

<p>###JavaEE 6</p>

<ul>
<li>Right sizing

<ul>
<li>拡張性</li>
<li>ライブラリやフレームワークを有効活用する方向で</li>
<li>プロファイル</li>
<li>Java EE のサブセットを提供</li>
</ul></li>
<li>仕様の削減

<ul>
<li>古い・使われない仕様の削減</li>
</ul></li>
<li>かんたん開発

<ul>
<li>すべての Web API をアノテーションで使用</li>
</ul></li>
</ul>

<p>###GlassFish v3</p>

<ul>
<li>JRuby などのスクリプト言語のサポート</li>
<li>GlassFish v3 prelude

<ul>
<li>Ruby on Rails のネイティブサポート</li>
<li>ここが気になるところ</li>
</ul></li>
<li>計量・高速起動</li>
</ul>

<p>##MySQLをパワーアップ！MySQLサポートツールズを使ってみよう
###アジェンダ</p>

<ul>
<li>MySQLをとりまくエコシステム</li>
<li>Memcached/DRBD</li>
<li>MySQL Enterprise Monitor</li>
<li>MySQL Workbench</li>
<li>MySQL Proxy</li>
<li>Connector/C++</li>
</ul>

<p>###MySQL 紹介</p>

<ul>
<li>MySQL 5.1 GA 登場

<ul>
<li>パーティショニング</li>
</ul></li>
</ul>

<p>###MySQL を取り巻くツール</p>

<ul>
<li>memcached

<ul>
<li>キャッシュを全体で共用することができる</li>
</ul></li>
<li>DRBD

<ul>
<li>ネットワーク越しのミラーリング</li>
<li>Heartbeat で Failover 構成がとれる</li>
</ul></li>
<li>MySQL Enterprise Monitor

<ul>
<li>問題のあるクエリの発見，そしてチューニングができる</li>
<li>「起こる前に」問題を特定できる</li>
<li>Gold 以上で Query Analyzer が使える</li>
<li>クエリチューニングの難しいところ</li>
<li>ユーザやアプリの動作の把握が難しい</li>
<li>サーバはパフォーマンスを収集するようにはできていない</li>
<li>Slow Query Log ではわかりにくい

<ul>
<li>調査しづらい</li>
</ul></li>
<li>SHOW PROCESSLIST/EXPALIN ではどうなっているのか，どうすればいいのかがわかりにくい．</li>
</ul></li>
<li>SHOW PROFILES

<ul>
<li>5.1 からデフォルトで有効になっている</li>
<li>クエリーの詳細な情報を表示できる</li>
</ul></li>
<li>MySQL クエリアナライザー

<ul>
<li>MySQL Proxy 上で動作する</li>
<li>パフォーマンスの劣化は 15%-20% 程度</li>
</ul></li>
<li>MySQL Workbench

<ul>
<li>Linux/Mac OSX で alpha がでてる</li>
<li>SQL IDE も統合予定</li>
</ul></li>
<li>MySQL Proxy

<ul>
<li>更新・参照のサーバ振り分けとかできる</li>
<li>最新版は launchpad で公開中</li>
</ul></li>
<li>Connector/C++

<ul>
<li>CMake で</li>
<li>Windows とソースコードを一本化する都合で導入されたもの</li>
<li>build するときの Make ファイルを，C コンパイラに応じて作成する

<ul>
<li>configure のようなもの？</li>
<li>Windows なら Visual Studio のプロジェクトファイルを作成できるそうだ</li>
</ul></li>
</ul></li>
</ul>

<p>##まとめなど</p>

<ul>
<li>MySQL Proxy は使いどころありそうなので，検証してみる</li>
<li>仮想化を本格的に導入してないといけないな</li>
</ul>


  <div class="share-buttons">
    <div class="fb-like" data-href="https://stnard.jp/2009/02/21/osc2009-tokyospring-OSC-2009-Tokyo-Sprint-1st-Day/" data-layout="button_count" data-action="like" data-size="small" data-show-faces="true" data-share="true"></div>
    <div class="hatena-share-button"><a href="http://b.hatena.ne.jp/entry/" class="hatena-bookmark-button" data-hatena-bookmark-layout="standard-balloon" data-hatena-bookmark-lang="ja" title="このエントリーをはてなブックマークに追加"><img src="https://b.st-hatena.com/images/entry-button/button-only@2x.png" alt="このエントリーをはてなブックマークに追加" width="20" height="20" style="border: none;" /></a><script type="text/javascript" src="https://b.st-hatena.com/js/bookmark_button.js" charset="utf-8" async="async"></script></div>
    <div class="twitter-share-button"><a href="https://twitter.com/share" class="twitter-share-button" data-via="conceal_rs">Tweet</a> <script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+'://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js,fjs);}}(document, 'script', 'twitter-wjs');</script></div>
</div>
<div id="fb-root"></div>
<script>(function(d, s, id) {
     var js, fjs = d.getElementsByTagName(s)[0];
     if (d.getElementById(id)) return;
     js = d.createElement(s); js.id = id;
     js.src = "//connect.facebook.net/ja_KS/sdk.js#xfbml=1&version=v2.8";
     fjs.parentNode.insertBefore(js, fjs);
 }(document, 'script', 'facebook-jssdk'));</script>


  
<div class="prev-next-post pure-g">
  <div class="pure-u-1-24" style="text-align: left;">
    
    <a href="https://stnard.jp/2009/02/21/osc2009-tokyospring-OSC-2009-Tokyo-Sprint-2st-Day/"><i class="fa fa-chevron-left"></i></a>
    
  </div>
  <div class="pure-u-10-24">
    
    <nav class="prev">
      <a href="https://stnard.jp/2009/02/21/osc2009-tokyospring-OSC-2009-Tokyo-Sprint-2st-Day/">OSC 2009 Tokyo/Sprint 2st Day</a>
    </nav>
    
  </div>
  <div class="pure-u-2-24">
    &nbsp;
  </div>
  <div class="pure-u-10-24">
    
    <nav class="next">
      <a href="https://stnard.jp/2009/02/24/ruby-rails-Rails-2-3-0-MiddlewareStack/">Rails 2.3.0で MiddlewareStack に積む方法</a>
    </nav>
    
  </div>
  <div class="pure-u-1-24" style="text-align: right;">
    
    <a href="https://stnard.jp/2009/02/24/ruby-rails-Rails-2-3-0-MiddlewareStack/"><i class="fa fa-chevron-right"></i></a>
    
  </div>
</div>



  
<div id="disqus_thread"></div>
<script type="text/javascript">

(function() {
    
    
    if (window.location.hostname == "localhost")
        return;

    var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
    var disqus_shortname = 'stnardsdiary';
    dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
})();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com/" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>


</div>

</div>
</div>
<script src="https://stnard.jp/js/ui.js"></script>


<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-33462373-1', 'auto');
  ga('send', 'pageview');

</script>



</body>
</html>

